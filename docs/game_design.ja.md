# 仕様

## 概要

俯瞰視点の2D RPG。
魔法または技の連続発動による合成で異なる効果を楽しめる、
また、魔法の効果は入力した数値の性質によって変化する。

## グラフィック

16 x 16 のタイルマップ

## データ構造

tiletype_to_surf タイルの種類に対するpygame.Surfaceの辞書。str: pygame.Surface
assetname_to_filepath ファイルパスに対するエイリアス名辞書。 AssetFinderがこの役目を担う

## シナリオ

魔法使いの師弟が、無限に階数が続く塔or地下へ挑む。

## Integer Spell

このゲームのMagic（魔法）は、プレイヤーが自作することができる。
魔法は複数のtrait（特性）、一つのalchemical_element（属性）を持ち、その内容によって効果を分岐する。

魔法は生成関数を通して作成される。その引数にはinteger_spell（整数呪文、整数値）、strength（強さ）をとり、その整数の性質によって特性、属性が決定するのが独自の特徴。

プレイヤーはmp（マナ）を持ち、魔法を作成するごとに、その強さ分消費する。つまり、強さの最大値＝マナの最大値
マナは歩くごとに微量ずつ回復する。
魔法はspell（呪文）として自分でオリジナルの名前を付けて作成、スロットに保存することができる。
非戦闘時以外でもアドリブで放つこともできる。アドリブで打つとマナの消費量が増える。
魔法の効果は整数呪文から推測する以外では、使うことで初めて発覚する。発覚した際、その内容がmemo（メモ）に記録される。このmemo（メモ）はいつでも編集できる。

## ステータス

キャラクターは複数のresistance（耐性）を持つ。対応する種類の属性のダメージを受けるとき、その耐性が正なら被ダメージ軽減、負なら被ダメージ増加。

- hp
  - max
  - current
- mp
  - max
  - current
- physical_ability
- armaments
- resistances {alchemical_element: resistance_value}
- spells {name: {integer_spell: int, strength: int, memo: str}}

## 戦闘

シンボルエンカウントで戦闘画面に移行する。
ターン性で行われる。

### trait（特性）

|種類|説明|
|----|----|
|confusion（混乱）|受けた相手は、次の行動の効果対象がランダムになる|
||

### プレイヤーターン

戦闘メニューから行動を選択できる。

- 足掻く
- 呪文
  - 今考える
  - スロットに登録した呪文を一覧表示
- 道具
- 身を守る
- 逃げる

足掻くと装備を頼りに戦う。効果はphysical_ability（身体能力）に依存する。
呪文から魔法を選ぶ。
道具から道具を選んで使用する。
身を守るを使うと、その次の被攻撃ターンだけ全属性の耐性をランダムな数値で得る。
逃げるとマナを消費する。マナが無いと逃げられない。戦闘を繰り返すほど必要な消費量が多くなる。

### 計算

被攻撃者をdefender、攻撃者をoffenderとする
commandに戦闘メニュー、もしくは敵AIによる行動選択を格納する。

#### command:足掻く

defender.hp -= rng(offender.physical_ability)
offenderのarmamentそれぞれを調べ、それが持つtraitによってdefenderもしくはoffenderに影響を与える。

#### 
